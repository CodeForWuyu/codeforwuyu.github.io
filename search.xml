<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>electron学习:实现一个文件分类器</title>
      <link href="2021/03/29/electron%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%88%86%E7%B1%BB%E5%99%A8/"/>
      <url>2021/03/29/electron%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%88%86%E7%B1%BB%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="sunny-动机"><a href="#sunny-动机" class="headerlink" title=":sunny:动机"></a><span class="github-emoji"><span>☀</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2600.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>动机</h2><p>因为喜欢看电子书,之前都用多看,但是没有花钱买过多看里面的书,会找很多epub的电子书资源.  (现在用微信读书了,蛮香的,都是正版,而且基本不用花钱)</p><p>电子书资源网站现在死的好多,但还是有很多百度网盘的资源. 整理的都很好, 大部分都包含了多种格式的电子书,其中就包括了epub.</p><p>曾经一次性下载了很多百度网盘的电子书资源,epub文件都在各自的文件夹内,要传到多看上的话就要一次次的打开所有文件夹.  很烦,当时写了一个小脚本,如下:</p><pre class="line-numbers language-python" data-language="python"><div class="caption"><span>python提取epub</span></div><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> shutildir_path <span class="token operator">=</span> <span class="token string">"D:\BaiduNetdiskDownload"</span>epub_path <span class="token operator">=</span> <span class="token string">"D:\BaiduNetdiskDownload\epub"</span><span class="token keyword">for</span> path<span class="token punctuation">,</span>dir_list<span class="token punctuation">,</span>file_list <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>dir_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> file_name <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>        <span class="token keyword">if</span> file_name<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">".epub"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>path<span class="token punctuation">,</span> file_name<span class="token punctuation">)</span><span class="token punctuation">)</span>            old_file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>path<span class="token punctuation">,</span> file_name<span class="token punctuation">)</span>            new_file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>epub_path<span class="token punctuation">,</span>file_name<span class="token punctuation">)</span>            shutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span>old_file_path<span class="token punctuation">,</span>new_file_path<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>后来在公司的项目中接触到了vue写前端,也知道了electron这个东西,就决定学习一下,把这个可视化的文件分类器作为一个学习的小项目.  </p><p>功能很简陋,实现也不完美,作为一个入门的小程序,勉勉强强.</p><h2 id="sunflower-设计思路"><a href="#sunflower-设计思路" class="headerlink" title=":sunflower:设计思路"></a><span class="github-emoji"><span>🌻</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f33b.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>设计思路</h2><p>​    因为是一个非常简单的项目,设计思路也很简单.</p><ol><li>首页用一个输入框点击可以像选择想要处理的文件夹</li><li>将文件夹存储到vuex中</li><li>选择文件夹后,出现处理按钮,点击跳转到文件列表页面</li><li>利用vuex中的文件夹,遍历获取文件夹下面所有文件,构造一个以文件类型为key的map, 作为文件map,也存储到vuex中</li><li>文件列表页面分类展示所有文件</li><li>每一类文件都有复制和移动功能</li><li>复制/移动允许用户选择一个文件夹,在该文件夹下面新建一个文件,以文件类型为文件名, 根据按钮,将相同类型文件复制或者移动到新文件夹</li><li>结束</li></ol><h2 id="bell-框架选择"><a href="#bell-框架选择" class="headerlink" title=":bell:框架选择"></a><span class="github-emoji"><span>🔔</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f514.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>框架选择</h2><p>因为在公司的项目中使用的是vue+elementui来写前端。 因此想要找一个同样支持vue的electron现有框架来写。 在github上找到了<a href="https://github.com/SimulatedGREG/electron-vue%EF%BC%8C%E6%84%9F%E8%A7%89%E5%BE%88%E5%A5%BD%E7%94%A8%E3%80%82">https://github.com/SimulatedGREG/electron-vue，感觉很好用。</a></p><p>在UI库方面，用过element-ui，已经是很好用的一个库了。 但是想试试别的，一开始选择了bulma，后来在开发过程中，觉得这个不够“傻瓜式”，于是又引入了iview。</p><p>最终选择：</p><ol><li><a href="https://github.com/SimulatedGREG/electron-vue">electron-vue</a></li><li><a href="https://bulma.zcopy.site/documentation/overview/">bulma</a></li><li><a href="https://www.iviewui.com/docs/introduce">iviewui</a></li></ol><h2 id="loudspeaker-具体实现"><a href="#loudspeaker-具体实现" class="headerlink" title=":loudspeaker:具体实现"></a><span class="github-emoji"><span>📢</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4e2.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>具体实现</h2><h3 id="首页实现"><a href="#首页实现" class="headerlink" title="首页实现"></a>首页实现</h3><p>​    首页需求很简单，只要一个输入框，用来选择文件夹，然后将文件夹存储到vuex, 并根据文件夹,获取所有文件列表,存储到vuex</p><p>​    实现界面如下：<img src="%E9%A6%96%E9%A1%B5.png"></p><h3 id="文件夹选择"><a href="#文件夹选择" class="headerlink" title="文件夹选择"></a>文件夹选择</h3><ul><li>remote.dialog.showOpenDialog是electon提供的对话框函数</li></ul><pre class="line-numbers language-js" data-language="js"><div class="caption"><span>选择文件夹</span></div><code class="language-js"><span class="token comment">//打开文件夹    </span><span class="token function">openDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">const</span> result <span class="token operator">=</span> remote<span class="token punctuation">.</span>dialog<span class="token punctuation">.</span><span class="token function">showOpenDialog</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        properties<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'openFile'</span><span class="token punctuation">,</span><span class="token string">"openDirectory"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>dir <span class="token operator">=</span> result    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token comment">//将文件夹路径设置为全局状态</span>    <span class="token function">setPath</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'ChangePath'</span><span class="token punctuation">,</span>path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAllFile</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">// 获取所有文件</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'saveList'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>filesArray<span class="token punctuation">)</span> <span class="token comment">//存储到vuex</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="文件目录扫描"><a href="#文件目录扫描" class="headerlink" title="文件目录扫描"></a>文件目录扫描</h3><p>​    使用nodejs的fs模块和path模块</p><ul><li>fs.stat()  给定路径,获取文件信息</li><li>path.join()  路径和文件名生成完整路径</li></ul><pre class="line-numbers language-js" data-language="js"><div class="caption"><span>文件目录保存</span></div><code class="language-js"> <span class="token comment">// 获取文件夹下所有文件</span><span class="token function">getAllFile</span><span class="token punctuation">(</span><span class="token parameter">targetPath</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">let</span> that  <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>    fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>targetPath<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">filename</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// 遍历当前path下所有文件</span>                <span class="token keyword">let</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>targetPath<span class="token punctuation">,</span>filename<span class="token punctuation">)</span>                fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 判断文件是否是文件夹</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>                        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>                    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                        <span class="token keyword">let</span> isFile <span class="token operator">=</span> stats<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">let</span> isDir <span class="token operator">=</span> stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>isFile<span class="token punctuation">)</span><span class="token punctuation">{</span>                            <span class="token comment">// console.log(filename)</span>                            that<span class="token punctuation">.</span>filesArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>   <span class="token comment">//递归处理文件夹</span>                        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                            that<span class="token punctuation">.</span><span class="token function">getAllFile</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>                        <span class="token punctuation">}</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="文件字典生成"><a href="#文件字典生成" class="headerlink" title="文件字典生成"></a>文件字典生成</h3><p>将vuex中存储的文件列表生成一个文件字典</p><pre class="line-numbers language-js" data-language="js"><div class="caption"><span>文件字典</span></div><code class="language-js"><span class="token comment">/** * 文件分类函数 */</span><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">"../store"</span><span class="token punctuation">;</span><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Classifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// 文件分类存储字典</span>    <span class="token keyword">let</span> fileMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    store<span class="token punctuation">.</span>getters<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment">// console.log(item)</span>        <span class="token comment">// TODO 实现文件分类</span>        <span class="token comment">// 解析文件路径</span>        <span class="token keyword">let</span> fileInfo <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileMap<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span>ext<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            fileMap<span class="token punctuation">[</span>fileInfo<span class="token punctuation">.</span>ext<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token punctuation">}</span>        fileMap<span class="token punctuation">[</span>fileInfo<span class="token punctuation">.</span>ext<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'saveMap'</span><span class="token punctuation">,</span>fileMap<span class="token punctuation">)</span>    <span class="token comment">// Object.keys(fileMap).forEach(function (item){</span>    <span class="token comment">//     console.log(item)</span>    <span class="token comment">//     console.log(fileMap[item])</span>    <span class="token comment">// })</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="文件列表页面实现"><a href="#文件列表页面实现" class="headerlink" title="文件列表页面实现"></a>文件列表页面实现</h3><h3 id="同类型文件复制"><a href="#同类型文件复制" class="headerlink" title="同类型文件复制"></a>同类型文件复制</h3><h3 id="同类型文件移动"><a href="#同类型文件移动" class="headerlink" title="同类型文件移动"></a>同类型文件移动</h3><h2 id="bookmark-学到了什么"><a href="#bookmark-学到了什么" class="headerlink" title=":bookmark:学到了什么"></a><span class="github-emoji"><span>🔖</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f516.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>学到了什么</h2><h2 id="sob-哪里不足"><a href="#sob-哪里不足" class="headerlink" title=":sob:哪里不足"></a><span class="github-emoji"><span>😭</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f62d.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>哪里不足</h2>]]></content>
      
      
      
        <tags>
            
            <tag> electron </tag>
            
            <tag> javascript </tag>
            
            <tag> 学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客的开始</title>
      <link href="2021/03/14/%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%BC%80%E5%A7%8B/"/>
      <url>2021/03/14/%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%BC%80%E5%A7%8B/</url>
      
        <content type="html"><![CDATA[<p>​    上周通过RSS订阅了不少博客,那么多大神很让我敬佩,印象深刻的比如云风大佬,coolshell,鸟窝等等.  不仅在工作上特别牛逼, 在知识输出上也坚持那么多年, 孜孜不倦.  </p><p>​    我虽然是个菜鸡,但也有个成为大牛的梦想. 所以尝试一下写一写技术博客.  其实之前在自己租的腾讯云服务器上,基于halo部署了一个博客, halo是基于springboot的.  但是自己租的服务器太low,打开博客费了老劲,只能用来学习linux,学习docker啥的.  所以今天用hexo部署到了github上. 希望以后能有稳定的产出.  初步希望一个月能写两篇有质量的博客.  加油!!!</p>]]></content>
      
      
      <categories>
          
          <category> 杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 杂记 </tag>
            
            <tag> 感想 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
